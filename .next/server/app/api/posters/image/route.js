"use strict";(()=>{var e={};e.id=181,e.ids=[181],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1017:e=>{e.exports=require("path")},3665:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>m,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>f,staticGenerationAsyncStorage:()=>d});var n={};r.r(n),r.d(n,{POST:()=>p});var s=r(9303),o=r(8716),a=r(670),i=r(7070),u=r(1617);async function p(e){try{let{id:t,poster_base64:r}=await e.json();if(!t||!r)return i.NextResponse.json({error:"缺少必要参数"},{status:400});if(!(0,u.Qk)(t))return i.NextResponse.json({error:"海报不存在"},{status:404});return(0,u.iW)(t,r),i.NextResponse.json({success:!0})}catch(e){return console.error("保存失败:",e),i.NextResponse.json({error:"保存失败"},{status:500})}}let c=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/posters/image/route",pathname:"/api/posters/image",filename:"route",bundlePath:"app/api/posters/image/route"},resolvedPagePath:"C:\\Users\\dou12\\Desktop\\乔钰成\\华东师范大学\\大一\\programming\\trae\\app\\api\\posters\\image\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:f}=c,g="/api/posters/image/route";function m(){return(0,a.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:d})}},1617:(e,t,r)=>{let n,s;r.d(t,{uM:()=>f,Qk:()=>g,iW:()=>m,Ih:()=>x});let o=require("fs");var a=r.n(o),i=r(1017),u=r.n(i);let p=require("node:crypto"),c=u().join(process.cwd(),"posters.json");function l(){if(!a().existsSync(c))return{};try{let e=a().readFileSync(c,"utf-8");return JSON.parse(e)}catch{return{}}}function d(e){a().writeFileSync(c,JSON.stringify(e,null,2))}function f(e){let t=l(),r=function(e=21){var t;t=e|=0,!n||n.length<t?(n=Buffer.allocUnsafe(128*t),p.webcrypto.getRandomValues(n),s=0):s+t>n.length&&(p.webcrypto.getRandomValues(n),s=0),s+=t;let r="";for(let t=s-e;t<s;t++)r+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[63&n[t]];return r}(8);return t[r]={...e,id:r,created_at:new Date().toISOString()},d(t),r}function g(e){return l()[e]||null}function m(e,t){let r=l();r[e]&&(r[e].poster_base64=t,d(r))}function x(e,t){let r=l();r[e]&&(r[e].copies=t,d(r))}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[948,972],()=>r(3665));module.exports=n})();